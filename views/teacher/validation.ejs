<!DOCTYPE html>
<html >
<title>Admin</title><head> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="sweetalert2/dist/sweetalert2.all.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Lalezar" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Cairo" rel="stylesheet">
    </head>
<style>
body {
    font-family: 'Cairo', sgit ans-serif;
   background-color: rgb(240, 240, 240)
  }
table {
  border-collapse: collapse;
  border-spacing: 0;
  width: 100%;
  border: 1px solid #ddd;

}

th, td {
  text-align: right;  padding: 8px;

}


.topnav {
  overflow: hidden;
  background-color: #333;
}

.topnav a {
  float: left;
  display: block;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

.topnav a:hover {
  background-color: #ddd;
  color: black;
}



.topnav .icon {
  display: none;
}

@media screen and (max-width: 600px) {
  .topnav a:not(:first-child) {display: none;}
  .topnav a.icon {
    float: right;
    display: block;
  }
}

@media screen and (max-width: 600px) {
  .topnav.responsive {position: relative;}
  .topnav.responsive .icon {
    position: absolute;
    right: 0;
    top: 0;
  }
  .topnav.responsive a {
    float: none;
    display: block;
    text-align: left;
  }
}
span {
  font-size: 20px
}

  body {
    font-family: 'Cairo', sans-serif;
  }
table {
  border-collapse: collapse;
  border-spacing: 0;
  width: 100%;
  border: 1px solid #ddd;

}

th, td {
  text-align: right;  padding: 8px;

}
tr:nth-child(even){background-color: #f2f2f2}

ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
  overflow: hidden;
  background-color:  rgb(73, 73, 73);
}

li {
  float: left;
  font-size: 20px
}

li a {
  display: block;
  color: white;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
}

li a:hover {
  background-color:  rgb(114, 114, 114);
  color: #f2f2f2;
  text-decoration: none
}
.activee  {
  background-color: rgb(73, 73, 73);
  color: #f2f2f2;
  text-decoration: none
}

</style>
</style>
<body>

  <div class="topnav" id="myTopnav">
    <a href="/teacher">حسابي</a>
    <a href="/teacher/valid">مراجعة الاسئلة</a>
    <a href="/teacher/question">اضافة سؤال </a>
    <a href="/teacher/notvalid"> الاسئلة الغير مقبولة </a>
          <a href="/logout"> تسجيل الخروج </a>
    <a href="javascript:void(0);" class="icon" onclick="myFunction()">
      <i class="fa fa-bars"></i>
    </a>
  </div>
  

  <div class="w3-container" style="text-align: right">

<div class="container" style="padding-top: 2%;width: 50%;">
  <h2 style="text-align: center;  font-family: 'Cairo', sans-serif; "> 
صفحة مراجعة الاسئلة
</h2><br><br>
  <% errors.forEach(function(error) { %>
  <div class="alert alert-danger" style="text-align: right" role="alert">
  <%= error %>
  </div>
  <% }) %>
  <% infos.forEach(function(info) { %>
  <div class="alert alert-info" role="alert">
  <%= info %>
  </div>
  <% }) %>
</div>

<!-- Button trigger modal -->

<div class="container">

    <% question.forEach(function(question) {%>
      <!-- this algo for comparison  -->
      <% if(question.TeacherOne !=  null) {  %>
    <% var userOne = JSON.stringify(question.TeacherOne._id) %>
      <% } else {  %>
        <%  var userOne = ""  %>
     <% } %>

     <% if(question.TeacherTwo !=  null) {  %>
      <%  var userTwo = JSON.stringify(question.TeacherTwo._id)%>
    <% } else {  %>
      <%  var userTwo = "" %>
   <% } %>

   <% if(question.TeacherFinal !=  null) {  %>
    <%  var userFinal = JSON.stringify(question.TeacherFinal._id)%>
  <% } else {  %>
    <%   var userFinal = "" %>
 <% } %>



      <% if ( 
             (JSON.stringify(question.Author._id) != JSON.stringify(currentUser._id))
       &&  (  (userOne != JSON.stringify(currentUser._id)) ||  JSON.stringify(question.IsValidOne) == "false" ) 
       &&   ( (userTwo != JSON.stringify(currentUser._id))   ||  JSON.stringify(question.IsValidTwo) == "false" ) 
       &&   ((userFinal != JSON.stringify(currentUser._id))  ||  JSON.stringify(question.IsValidFinal) == "false" ) 
       )  { %>
     

        <div class="card-deck" style="padding-bottom: 3%;" >
         
          <div class="card" style="padding: 3%;" >
        
            <div class="card-body" >
            
              <div class="row" dir="rtl"> 
              <div class="col-md-12" >
              
             
                <div class="row">
                    <% modules.forEach(function(module) {%>
                      <% if (  JSON.stringify(question.exam.module) == JSON.stringify(module._id) ) {  %>
                       
                    <% semsters.forEach(function(semster) {%>
                      <% if (  JSON.stringify(module.semster) == JSON.stringify(semster._id) ) {  %>
                      <br>
                   
                         <% levels.forEach(function(level) {%>
                      <% if (  JSON.stringify(semster.level) == JSON.stringify(level._id) ) {  %>
                        <% phases.forEach(function(phase) {%>
                          <% if (  JSON.stringify(level.phase) == JSON.stringify(phase._id) ) {  %>

                            <div class="col-md-3"> 
                                <h4><span style="border-bottom: 2px solid black">المرحلة </span> : <%= phase.Phase %><br></h4>
                      </div>
                        <div class="col-md-3"> 
                            <h4><span style="border-bottom: 2px solid black">الصف </span> : <%= level.Level %><br></h4>
                  </div>
                  <div class="col-md-3"> 
                      <h4><span style="border-bottom: 2px solid black">الفصل </span>   <%= semster.Semster %></h4></div>
                  <div class="col-md-3"> 
                      <h4><span style="border-bottom: 2px solid black">المادة </span>  <%= module.Module %></h4> </div>
                 <% } %>
                    <% } )%>
                    <% } %>
                    <% } )%>
                     
                 <% } %>
                    <% } )%>
                 <% } %>
                    <% } )%>
                    <div class="col-md-6"> 
                        <h4><span style="border-bottom: 2px solid black">الوحد </span> :  <%= question.Chapiter %> </h4>
                      
                           <h4 >  <span style="border-bottom: 2px solid black">نوع السؤال</span> : <%= question.TypeOfQuestion %> </h4>
                   </div>
                   <div class="col-md-6"> 
                      <h4><span style="border-bottom: 2px solid black">عنوان الدرس</span> :  <%= question.NameOfCourse %>   </h4>
                    
                     <h4 >  <span style="border-bottom: 2px solid black">درجة السؤال</span> : <%= question.Difficulty %></h4>
                    </div>
                   </div>
            
              
              </div>
             
              <% i = 0 %>
              <div class="col-md-12"> 
                  <h4> السؤال  :  </h4>
                  <div style=" background-color: rgb(242, 255, 239);   border-radius: 8px; margin: 2%;padding: 2%">
           
                    <h5> <%- question.Question %></h5>
                       <% if (question.QuestionImage != "") {%>
                      <img src="/uploads/<%= question.QuestionImage %>" width="80%">
                  <br>
                   <br>
                    <%}%>
               </div>
          </div>
              <% responses.forEach(function(response) {%>
               
                <% if (JSON.stringify(question._id) == JSON.stringify(response.question)) {%>
                  <div class="col-md-6" > 
                      <div style=" background-color: rgb(242, 255, 239);   border-radius: 8px; margin: 2%;padding: 2%">
                           <% i = i +1 %>
                           <% if (response.IsCorrect === true ) { %>
                         <p style="color: green">الجواب <%= i  %> </p>
                         <% } else { %>
                           <p style="color: red">الجواب <%= i  %></p>
                           <% } %>
                             <% if (response.ResponseImage != "") {%>
                               <%= response.ResponseImage %>
                               <img src="/uploads/<%= response.ResponseImage %>" width="80%">  
                             <%}%>
                             <%if  (response.ResponseText != "") {%>
                           <p>  <%= response.ResponseText  %>  </p> 
                             <%}%>
                           </div>
                         </div>
                           <%}%>
                          
                       
                     <%})%> 
                     
                   
                       <div class="col-md-12" > 
                           <h4> الاجابة النموذجية:  </h4>
                           <div style=" background-color: rgb(242, 255, 239);   border-radius: 8px; margin: 2%;padding: 2%">
                        
                             <h5> <%- question.Response %></h5>
                         
                       </div>
                       
                       <div class="col-md-12" > 
                         <div class="row">
                           <div class="col-md-3" > 
                               <h4> اسم المعلم المدخل:  </h4>
                               <div style=" background-color: rgb(242, 255, 239);   border-radius: 8px; margin: 2%;padding: 2%;height: 50px">
                            
                                 <h5> <%= question.Author.Firstname +" " +  question.Author.Lastname  %></h5>
                             
                           </div> </div>
                           <div class="col-md-3" > 
                               <h4> اسم  المراقب الاول:  </h4>
                               <div style=" background-color: rgb(242, 255, 239);   border-radius: 8px; margin: 2%;padding: 2%; height: 50px">
                               <% if ( question.TeacherOne != null) { %>
                                 <h5><%= question.TeacherOne.Firstname +" " + question.TeacherOne.Lastname %></h5>
                              <% } else { %>
                              <h5></h5>
                              <% } %>
                           </div> </div>
                           <div class="col-md-3" > 
                               <h4> اسم  المراقب الثاني:  </h4>
                               <div style=" background-color: rgb(242, 255, 239);   border-radius: 8px; margin: 2%;padding: 2%; height: 50px"> 
                             <% if ( question.TeacherTwo != null) { %>
                                 <h5> <%= question.TeacherTwo.Firstname +" " + question.TeacherTwo.Lastname  %></h5>
                                 <% } else { %>
                                   <h5></h5>
                                   <% } %>
                           </div> </div>
                           <div class="col-md-3" > 
                               <h4> اسم  المدقق:  </h4>
                               <div style=" background-color: rgb(242, 255, 239);   border-radius: 8px; margin: 2%;padding: 2%;height: 50px">
                               <% if ( question.TeacherFinal != null) { %>
                                 <h5> <%= question.TeacherFinal.Firstname +" " + question.TeacherFinal.Lastname  %></h5>
                                 <% } else { %>
                                   <h5></h5>
                                   <% } %>
                                  </div> </div></div>
              <p class="card-text" style="text-align: center"><small class="text-muted"><%= question.createdAt %></small></p>
            </div> </div>
            <hr>
           
          </div>
          <div style="margin: 20px"> 
           
            <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#<%= question._id %>exampleModal">
                اشعار بوجود خطأ
              </button>
              
              <!-- Modal -->
              <div class="modal fade" id="<%= question._id %>exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content" >
                        <div class="modal-header">
                          
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="float: right" >
                            <span aria-hidden="true">&times;  الغاء</span>
                          </button>
                    </div><form action="/invalid/question/<%= question._id %>" method="post">
                    <div class="modal-body" dir="rtl">
                        <label>صف الخطأ </label>
                          <textarea name="message" class="form-control" style="text-align: right"></textarea>
                        
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">الغاء</button>
                      <button type="submit" class="btn btn-primary">ارسال </button>
                    </div></form>
                  </div>
                </div>
              </div>
                     
          <a href="/valid/question/<%= question._id %>" class="btn  btn-success" style="width: 100px" > لا يوجد خطأ </a>
        </div>
        </div>       
      </div>
       
   
</div>
      
        <%  } %>
        <%})%> 
</div>

 <br>




 <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
 <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
 



    <script>
      function myFunction() {
        var x = document.getElementById("myTopnav");
        if (x.className === "topnav") {
          x.className += " responsive";
        } else {
          x.className = "topnav";
        }
      }
      </script>
      
   </body>
</html>
